{"conceptual":"\n<h2 id=\"eventstoreconnection\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"8\" sourceendlinenumber=\"8\">EventStoreConnection</h2>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"10\" sourceendlinenumber=\"10\">The <code>EventStoreConnection</code> class maintains a full-duplex connection between the client and the Event Store server. <code>EventStoreConnection</code> is thread-safe and we recommend that you create one instance per application.</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"12\" sourceendlinenumber=\"12\">All operations are fully asynchronous and return either a <code>Task</code> or a <code>Task&lt;T&gt;</code>. If you need to execute synchronously, call <code>.Wait()</code>, or <code>Result</code> on the asynchronous version.</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"14\" sourceendlinenumber=\"14\">To get maximum performance from the connection we recommend that you use it asynchronously.</p>\n<div class=\"NOTE\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"16\" sourceendlinenumber=\"16\"><h5>Note</h5><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"17\" sourceendlinenumber=\"17\">The <code>Create</code> methods have changed slightly moving to 3.0.2 as connection strings are now supported. The old mechanisms will still work but have been marked obsolete and will be removed in the future.</p>\n</div>\n<h2 id=\"creating-a-connection\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"19\" sourceendlinenumber=\"19\">Creating a Connection</h2>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"21\" sourceendlinenumber=\"21\">The <code>EventStoreConnection</code> classes uses the static <code>Create</code> methods to create a new connection. All method overloads allow you to optionally specify a name for the connection, which is returned when the connection raises events (see <a href=\"#connection-events\" data-raw-source=\"[Connection Events](#connection-events)\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"21\" sourceendlinenumber=\"21\">Connection Events</a>).</p>\n<table>\n    <thead>\n        <tr>\n            <th>Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>Create(Uri uri)</code></td>\n            <td>Connects to Event Store (see URIs below) with default settings</td>\n        </tr>\n        <tr>\n            <td><code>Create(ConnectionSettings connectionSettings, Uri uri)</code></td>\n            <td>Connects to Event Store (see URIs below) with specified settings</td>\n        </tr>\n        <tr>\n            <td><code>Create(string connectionString)</code></td>\n            <td>Connects to Event Store (see URIs below) with settings from connection string</td>\n        </tr>\n        <tr>\n            <td><code>(obsolete) Create(IPEndPoint tcpEndPoint)</code></td>\n            <td>Connects to a single node with default settings</td>\n        </tr>\n        <tr>\n            <td><code>(obsolete) Create(ConnectionSettings settings, IPEndPoint tcpEndPoint)</code></td>\n            <td>Connects to a single node with custom settings (see <a href=\"#customising-connection-settings\">Customising Connection Settings</a>)</td>\n        </tr>\n        <tr>\n            <td><code>(obsolete) Create(ConnectionSettings connectionSettings, ClusterSettings clusterSettings)</code></td>\n            <td>Connects to an Event Store HA cluster with custom settings (see <a href=\"#cluster-settings\">Cluster Settings</a>)</td>\n        </tr>\n    </tbody>\n</table>\n\n<div class=\"NOTE\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"58\" sourceendlinenumber=\"58\"><h5>Note</h5><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"59\" sourceendlinenumber=\"59\">The connection returned by these methods is inactive. Use the <code>ConnectAsync()</code> method to establish a connection with the server.</p>\n</div>\n<h2 id=\"uris\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"61\" sourceendlinenumber=\"61\">URIs</h2>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"63\" sourceendlinenumber=\"63\">The create methods support passing of a URI to the connection as opposed to passing <code>IPEndPoints</code>. This URI should be in the format of:</p>\n<ul sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"65\" sourceendlinenumber=\"66\">\n<li sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"65\" sourceendlinenumber=\"65\"><strong>Single Node</strong>: <code>tcp://user:password@myserver:11234</code></li>\n<li sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"66\" sourceendlinenumber=\"66\"><strong>Cluster</strong>: <code>discover://user:password@myserver:1234</code></li>\n</ul>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"68\" sourceendlinenumber=\"68\">Where the port number points to the TCP port of the Event Store instance (1113 by default) or points to the manager gossip port for discovery purposes.</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"70\" sourceendlinenumber=\"70\">With the URI based mechanism you can pass a domain name and the client will resolve it.</p>\n<div class=\"NOTE\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"72\" sourceendlinenumber=\"72\"><h5>Note</h5><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"73\" sourceendlinenumber=\"73\">The client performs a blocking DNS call for single node. If you are worried about blocking DNS due to network issues etc., you should resolve the DNS yourself and pass in an IP address.</p>\n</div>\n<h2 id=\"customising-connection-settings\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"75\" sourceendlinenumber=\"75\">Customising Connection Settings</h2>\n<h3 id=\"connection-string\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"77\" sourceendlinenumber=\"77\">Connection String</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"79\" sourceendlinenumber=\"79\">Many of the overloads accept a connection string that you can use to control settings of the connection. A benefit to having these as a connection string instead of using the fluent API is that you can change them between environments without recompiling (say single node in <code>dev</code> and a cluster in <code>production</code>).</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"81\" sourceendlinenumber=\"81\">The connection string format should look familiar to those who have used connection strings in the past. It consists of a series of key/value pairs Key = Value separated by semicolons.</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"83\" sourceendlinenumber=\"83\">You can set the following values using the connection string.</p>\n<!-- TODO: Moved, to check and what about ConnectTo? -->\n<table>\n    <thead>\n        <tr>\n            <th>Name</th>\n            <th>Format</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>VerboseLogging</td>\n            <td>True/false</td>\n            <td>Enables verbose logging</td>\n        </tr>\n        <tr>\n            <td>MaxQueueSize</td>\n            <td>Integer</td>\n            <td>Maximum number of outstanding operations</td>\n        </tr>\n        <tr>\n            <td>MaxConcurrentItems</td>\n            <td>Integer</td>\n            <td>Maximum number of concurrent async operations</td>\n        </tr>\n        <tr>\n            <td>MaxRetries</td>\n            <td>Integer</td>\n            <td>Maximum number of retry attempts</td>\n        </tr>\n        <tr>\n            <td>MaxReconnections</td>\n            <td>Integer</td>\n            <td>The maximum number of times to try reconnecting</td>\n        </tr>\n        <tr>\n            <td>RequireMaster</td>\n            <td>True/false</td>\n            <td>If set the server will only process if it is master</td>\n        </tr>\n        <tr>\n            <td>ReconnectionDelay</td>\n            <td>Integer (milliseconds)</td>\n            <td>The delay before attempting to reconnect</td>\n        </tr>\n        <tr>\n            <td>OperationTimeout</td>\n            <td>Integer (milliseconds)</td>\n            <td>The time before considering an operation timed out</td>\n        </tr>\n        <tr>\n            <td>OperationTimeoutCheckPeriod</td>\n            <td>Integer (milliseconds)</td>\n            <td>The frequency in which to check timeouts</td>\n        </tr>\n        <tr>\n            <td>DefaultUserCredentials</td>\n            <td>String in format username:password</td>\n            <td>The default credentials for the connection</td>\n        </tr>\n        <tr>\n            <td>UseSslConnection</td>\n            <td>True/false</td>\n            <td>whether to use SSL for this connection</td>\n        </tr>\n        <tr>\n            <td>TargetHost</td>\n            <td>String</td>\n            <td>The hostname expected on the certificate</td>\n        </tr>\n        <tr>\n            <td>ValidateServer</td>\n            <td>True/false</td>\n            <td>Whether to validate the remote server</td>\n        </tr>\n        <tr>\n            <td>FailOnNoServerResponse</td>\n            <td>True/False</td>\n            <td>Whether to fail on no server response</td>\n        </tr>\n        <tr>\n            <td>HeartbeatInterval</td>\n            <td>Integer (milliseconds)</td>\n            <td>The interval at which to send the server a heartbeat</td>\n        </tr>\n        <tr>\n            <td>HeartbeatTimeout</td>\n            <td>Integer (milliseconds)</td>\n            <td>The amount of time to receive a heartbeat response before timing out</td>\n        </tr>\n        <tr>\n            <td>ClusterDns</td>\n            <td>string</td>\n            <td>The DNS name of the cluster for discovery</td>\n        </tr>\n        <tr>\n            <td>MaxDiscoverAttempts</td>\n            <td>Integer</td>\n            <td>The maximum number of attempts to try to discover the cluster</td>\n        </tr>\n        <tr>\n            <td>ExternalGossipPort</td>\n            <td>Integer</td>\n            <td>The port to try to gossip on</td>\n        </tr>\n        <tr>\n            <td>GossipTimeout</td>\n            <td>Integer (milliseconds)</td>\n            <td>The amount of time before timing out a gossip response</td>\n        </tr>\n        <tr>\n            <td>GossipSeeds</td>\n            <td>Comma separated list of ip:port</td>\n            <td>A list of seeds to try to discover from</td>\n        </tr>\n        <tr>\n            <td>ConnectTo</td>\n            <td>A URI in format described above to connect to</td>\n            <td>The URI to connect to</td>\n        </tr>\n    </tbody>\n</table>\n\n<div class=\"NOTE\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"209\" sourceendlinenumber=\"209\"><h5>Note</h5><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"210\" sourceendlinenumber=\"210\">You can also use spacing instead of camel casing in your connection string if you prefer.</p>\n</div>\n<pre sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"212\" sourceendlinenumber=\"214\"><code class=\"lang-csharp\">var connectionString = &quot;ConnectTo=tcp://admin:changeit@localhost:1113; HeartBeatTimeout=500&quot;\n</code></pre><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"216\" sourceendlinenumber=\"216\">Sets the connection string to connect to localhost on the default port and sets the heartbeat timeout to 500ms.</p>\n<pre sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"218\" sourceendlinenumber=\"220\"><code class=\"lang-csharp\">var connectionString = &quot;Connect To = tcp://admin:changeit@localhost:1113; Gossip Timeout = 500&quot;\n</code></pre><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"222\" sourceendlinenumber=\"222\">Using spaces:</p>\n<pre sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"224\" sourceendlinenumber=\"226\"><code class=\"lang-csharp\">var connectionString = &quot;ConnectTo=discover://admin:changeit@mycluster:3114; HeartBeatTimeout=500&quot;\n</code></pre><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"228\" sourceendlinenumber=\"228\">Tells the connection to try gossiping to a manager found under the DNS &#39;mycluster&#39; at port 3114 to connect to the cluster.</p>\n<pre sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"230\" sourceendlinenumber=\"232\"><code class=\"lang-csharp\">var connectionString = &quot;GossipSeeds=192.168.0.2:1111,192.168.0.3:1111; HeartBeatTimeout=500&quot;\n</code></pre><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"234\" sourceendlinenumber=\"234\">Tells the connection to try gossiping to the gossip seeds <code>192.168.0.2</code> or <code>192.168.0.3</code> on port 1111 to discover information about the cluster.</p>\n<div class=\"NOTE\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"236\" sourceendlinenumber=\"236\"><h5>Note</h5><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"237\" sourceendlinenumber=\"237\">See the fluent API below for defaults of values.</p>\n</div>\n<div class=\"NOTE\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"239\" sourceendlinenumber=\"239\"><h5>Note</h5><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"240\" sourceendlinenumber=\"240\">You can also use the <code>ConnectionString</code> class to return a <code>ConnectionSettings</code> object.</p>\n</div>\n<h3 id=\"fluent-api\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"242\" sourceendlinenumber=\"242\">Fluent API</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"244\" sourceendlinenumber=\"244\">Settings used for modifying the behaviour of an <code>EventStoreConnection</code> are encapsulated into an object of type <code>ConnectionSettings</code> which is passed as a parameter to the <code>Create</code> methods listed above.</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"246\" sourceendlinenumber=\"246\">Instances of <code>ConnectionSettings</code> are created using a fluent builder class:</p>\n<pre sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"248\" sourceendlinenumber=\"250\"><code class=\"lang-CSharp\">ConnectionSettings settings = ConnectionSettings.Create();\n</code></pre><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"252\" sourceendlinenumber=\"252\">This will create an instance of <code>ConnectionSettings</code> with the default options. These can be overridden by chaining the additional builder methods described below.</p>\n<h3 id=\"logging\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"254\" sourceendlinenumber=\"254\">Logging</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"256\" sourceendlinenumber=\"256\">The .NET API can log information to different destinations. By default logging is not enabled.</p>\n<!-- TODO: Moved, to check. Actually missing options. -->\n<table>\n    <thead>\n        <tr>\n            <th>Builder Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>UseConsoleLogger()</code></td>\n            <td>Output log messages using <code>Console.WriteLine</code></td>\n        </tr>\n        <tr>\n            <td><code>UseDebugLogger()</code></td>\n            <td>Output log messages using <code>Debug.WriteLine</code></td>\n        </tr>\n        <tr>\n            <td><code>UseCustomLogger()</code></td>\n            <td>Output log messages to the specified instance of <code>ILogger</code> (You should implement this interface in order to log using another library such as NLog or log4net).</td>\n        </tr>\n        <tr>\n            <td><code>EnableVerboseLogging()</code></td>\n            <td>Turns on verbose logging.<br>By default information about connection, disconnection and errors are logged, however it can be useful to have more information about specific operations as they are occuring.</td>\n        </tr>\n    </tbody>\n</table>\n\n<h3 id=\"user-credentials\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"287\" sourceendlinenumber=\"287\">User Credentials</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"289\" sourceendlinenumber=\"289\">Event Store supports <a href=\"~/server/access-control-lists.md\" data-raw-source=\"[Access Control Lists](~/server/access-control-lists.md)\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"289\" sourceendlinenumber=\"289\">Access Control Lists</a> that restrict permissions for a stream based on users and groups. <code>EventStoreConnection</code> allows you to supply credentials for each operation, however it is often more convenient to simply set some default credentials for all operations on the connection.</p>\n<!-- TODO: Moved, to check. -->\n<table>\n    <thead>\n        <tr>\n            <th>Builder Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>SetDefaultUserCredentials(UserCredentials credentials)</code></td>\n            <td>Sets the default <code>UserCredentials</code> to use for this connection. If no credentials are given, the opertation will use these.</td>\n        </tr>\n    </tbody>\n</table>\n\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"308\" sourceendlinenumber=\"308\">You create a <code>UserCredentials</code> object as follows:</p>\n<pre sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"310\" sourceendlinenumber=\"312\"><code class=\"lang-CSharp\">UserCredentials credentials = new UserCredentials(&quot;username&quot;,&quot;password&quot;);\n</code></pre><h3 id=\"security\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"314\" sourceendlinenumber=\"314\">Security</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"316\" sourceendlinenumber=\"316\">The .NET API and Event Store can communicate either over SSL or an unencrypted channel (by default).</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"318\" sourceendlinenumber=\"318\">To configure the client-side of the SSL connection, use the builder method below. For more information on setting up the server end of the Event Store for SSL, see <a href=\"~/server/setting_up_ssl.md\" data-raw-source=\"[SSL Setup](~/server/setting_up_ssl.md)\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"318\" sourceendlinenumber=\"318\">SSL Setup</a>.</p>\n<table>\n    <thead>\n        <tr>\n            <th>Builder Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>UseSslConnection(string targetHost, bool validateServer)</code></td>\n            <td>Uses an SSL-encrypted connection where:\n                <dl>\n                    <dt><code>targetHost</code></dt>\n                    <dd>Is the name specified on the SSL certificate installed on the server.</dd>\n                    <dt><code>validateServer</code></dt>\n                    <dd>Controls whether the connection validates the server certificate.</dd>\n                </dl>\n            </td>\n        </tr>\n    </tbody>\n</table>\n\n<div class=\"WARNING\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"342\" sourceendlinenumber=\"342\"><h5>Warning</h5><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"343\" sourceendlinenumber=\"343\">In production systems where credentials are sent from the client to Event Store, you should always use SSL-encryption and you should set <code>validateServer</code> to <code>true</code>.</p>\n</div>\n<h3 id=\"node-preference\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"345\" sourceendlinenumber=\"345\">Node Preference</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"347\" sourceendlinenumber=\"347\">When connecting to an Event Store HA cluster you can specify that operations are performed on any node, or only on the node that is the master.</p>\n<!-- TODO: Moved, to check. -->\n<table>\n    <thead>\n        <tr>\n            <th>Builder Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>PerformOnMasterOnly()</code></td>\n            <td>Require the master to serve all write and read requests (Default).</td>\n        </tr>\n        <tr>\n            <td><code>PerformOnAnyNode()</code></td>\n            <td>Allow for writes to be forwarded and read requests to be served locally if the current node is not master.</td>\n        </tr>\n    </tbody>\n</table>\n\n<h3 id=\"handling-failures\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"370\" sourceendlinenumber=\"370\">Handling Failures</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"372\" sourceendlinenumber=\"372\">The following methods on the <code>ConnectionSettingsBuilder</code> allow you to change the way the connection handles operation failures and connection issues.</p>\n<h4 id=\"reconnections\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"374\" sourceendlinenumber=\"374\">Reconnections</h4>\n<!-- TODO: Moved, to check. -->\n<table>\n    <thead>\n        <tr>\n            <th>Builder Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>WithConnectionTimeoutOf<br>(TimeSpan timeout)</code></td>\n            <td>Sets the timeout to connect to a server before aborting and attempting a reconnect (Default: 1 second).</td>\n        </tr>\n        <tr>\n            <td><code>LimitReconnectionsTo<br>(int limit)</code></td>\n            <td>Limits the number of reconnections this connection can try to make (Default: 10).</td>\n        </tr>\n        <tr>\n            <td><code>KeepReconnecting()</code></td>\n            <td>Allows infinite reconnection attempts.</td>\n        </tr>\n        <tr>\n            <td><code>SetReconnectionDelayTo<br>(TimeSpan reconnectionDelay)</code></td>\n            <td>Sets the delay between reconnection attempts (Default: 100ms).</td>\n        </tr>\n        <tr>\n            <td><code>SetHeartbeatInterval<br>(TimeSpan interval)</code></td>\n            <td>Sets how often the connection should expect heartbeats (lower values detect broken sockets faster) (Default: 750ms).</td>\n        </tr>\n        <tr>\n            <td><code>SetHeartbeatTimeout<br>(TimeSpan timeout)</code></td>\n            <td>Sets how long to wait without heartbeats before determining a connection to be dead (must be longer than the heatrbeat interval) (Default: 1500ms).</td>\n        </tr>\n    </tbody>\n</table>\n\n<h4 id=\"operations\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"413\" sourceendlinenumber=\"413\">Operations</h4>\n<table>\n    <thead>\n        <tr>\n            <th>Builder Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>SetOperationTimeout<br>(TimeSpan timeout)</code></td>\n            <td>Sets the operation timeout duration (Default: 7 seconds).</td>\n        </tr>\n        <tr>\n            <td><code>SetTimeoutCheckPeriodTo<br>(TimeSpan timeoutCheckPeriod)</code></td>\n            <td>Sets how often to check for timeouts (Default: 1 second).</td>\n        </tr>\n        <tr>\n            <td><code>LimitAttemptsForOperationTo<br>(int limit)</code></td>\n            <td>Limits the number of operation attempts (Default: 11).</td>\n        </tr>\n        <tr>\n            <td><code>LimitRetriesForOperationTo<br>(int limit)</code></td>\n            <td>Limits the number of operation retries (Default: 10).</td>\n        </tr>\n        <tr>\n            <td><code>KeepRetrying()</code></td>\n            <td>Allows infinite operation retries.</td>\n        </tr>\n        <tr>\n            <td><code>LimitOperationsQueueTo<br>(int limit)</code></td>\n            <td>Sets the limit for number of outstanding operations (Default: 5000).</td>\n        </tr>\n        <tr>\n            <td><code>FailOnNoServerResponse()</code></td>\n            <td>Marks that no response from server should cause an error on the request.</td>\n        </tr>\n    </tbody>\n</table>\n\n<h2 id=\"cluster-settings\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"454\" sourceendlinenumber=\"454\">Cluster Settings</h2>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"456\" sourceendlinenumber=\"456\">When connecting to an Event Store HA cluster you must pass an instance of <code>ClusterSettings</code> as well as the usual <code>ConnectionSettings</code>. Primarily yu use this to tell the <code>EventStoreConnection</code> how to discover all the nodes in the cluster. A connection to a cluster will automatically handle reconnecting to a new node if the current connection fails.</p>\n<h3 id=\"using-dns-discovery\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"458\" sourceendlinenumber=\"458\">Using DNS Discovery</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"460\" sourceendlinenumber=\"460\">DNS discovery uses a single DNS entry with several records listing all node IP addresses. The <code>EventStoreConnection</code> will then use a well known port to gossip with the nodes.</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"462\" sourceendlinenumber=\"462\">Use <code>ClusterSettings.Create().DiscoverClusterViaDns()</code> followed by:</p>\n<!-- TODO: Moved, to check. -->\n<table>\n    <thead>\n        <tr>\n            <th>Builder Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>SetClusterDns(string clusterDns)</code></td>\n            <td>Sets the DNS name under which to list cluster nodes.</td>\n        </tr>\n        <tr>\n            <td><code>SetClusterGossipPort(int clusterGossipPort)</code></td>\n            <td>Sets the well-known port on which the cluster gossip is taking place.</td>\n        </tr>\n        <tr>\n            <td><code>SetMaxDiscoverAttempts(int maxDiscoverAttempts)</code></td>\n            <td>Sets the maximum number of attempts for discovery (Default: 10).</td>\n        </tr>\n        <tr>\n            <td><code>SetGossipTimeout(TimeSpan timeout)</code></td>\n            <td>Sets the period after which gossip times out if none is received (Default: 1 second).</td>\n        </tr>\n    </tbody>\n</table>\n\n<div class=\"NOTE\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"493\" sourceendlinenumber=\"493\"><h5>Note</h5><p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"494\" sourceendlinenumber=\"494\">If you are using the commercial edition of Event Store HA with Manager nodes in place, the gossip port should be the port number of the external HTTP port on which the managers are running. If you are using the open source edition of Event Store HA the gossip port should be the External HTTP port that the nodes are running on. If you cannot use a well-known port for this across all nodes you can instead use gossip seed discovery and set the <code>IPEndPoint</code> of some seed nodes instead.</p>\n</div>\n<h3 id=\"connecting-using-gossip-seeds\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"496\" sourceendlinenumber=\"496\">Connecting Using Gossip Seeds</h3>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"498\" sourceendlinenumber=\"498\">The second supported method for node discovery uses a hardcoded set of <code>IPEndPoint</code>s as gossip seeds.</p>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"500\" sourceendlinenumber=\"500\">Use <code>ClusterSettings.Create().DiscoverClusterViaGossipSeeds()</code> followed by:</p>\n<!-- TODO: Moved, to check. -->\n<table>\n    <thead>\n        <tr>\n            <th>Builder Method</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>SetGossipSeedEndPoints(params IPEndPoint[] gossipSeeds)</code></td>\n            <td>Sets gossip seed endpoints for the client.</td>\n        </tr>\n        <tr>\n            <td><code>SetGossipSeedEndPoints(params GossipSeed[] gossipSeeds)</code></td>\n            <td>Same as above, but allows a specific <code>Host</code> header to be sent with all HTTP requests.</td>\n        </tr>\n        <tr>\n            <td><code>SetMaxDiscoverAttempts(int maxDiscoverAttempts)</code></td>\n            <td>Sets the maximum number of attempts for discovery (Default: 10).</td>\n        </tr>\n        <tr>\n            <td><code>SetGossipTimeout(TimeSpan timeout)</code></td>\n            <td>Sets the period after which gossip times out if none is received (Default: 1 second).</td>\n        </tr>\n    </tbody>\n</table>\n\n<h2 id=\"connection-events\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"531\" sourceendlinenumber=\"531\">Connection Events</h2>\n<p sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"533\" sourceendlinenumber=\"533\"><code>EventStoreConnection</code> exposes events that your application can use to be notifed of changes to the status of the connection.</p>\n<!-- TODO: Not moved. -->\n<table>\n    <thead>\n        <tr>\n            <th>Event</th>\n            <th>Description</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><code>EventHandler&lt;ClientConnectionEventArgs&gt; Connected</code></td>\n            <td>Fired when an <code>IEventStoreConnection</code> connects to an Event Store server.</td>\n        </tr>\n        <tr>\n            <td><code>EventHandler&lt;ClientConnectionEventArgs&gt; Disconnected</code></td>\n            <td>Fired when an <code>IEventStoreConnection</code> disconnects from an Event Store server by some means other than by calling the <code>Close</code> method.</td>\n        </tr>\n        <tr>\n            <td><code>EventHandler&lt;ClientReconnectingEventArgs&gt; Reconnecting</code></td>\n            <td>Fired when an <code>IEventStoreConnection</code> is attempting to reconnect to an Event Store server following a disconnection.</td>\n        </tr>\n        <tr>\n            <td><code>EventHandler&lt;ClientClosedEventArgs&gt; Closed</code></td>\n            <td>Fired when an <code>IEventStoreConnection</code> is closed either using the <code>Close</code> method or when reconnection limits are reached without a successful connection being established.</td>\n        </tr>\n        <tr>\n            <td><code>EventHandler&lt;ClientErrorEventArgs&gt; ErrorOccurred</code></td>\n            <td>Fired when an error is thrown on an <code>IEventStoreConnection</code>.</td>\n        </tr>\n        <tr>\n            <td><code>EventHandler&lt;ClientAuthenticationFailedEventArgs&gt; AuthenticationFailed</code></td>\n            <td>Fired when a client fails to authenticate to an Event Store server.</td>\n        </tr>\n    </tbody>\n</table>\n","type":"Conceptual","source":{"remote":{"path":"dotnet-api/connecting-to-a-server.md","branch":"swagger-docfx","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0,"endLine":0,"isExternal":false},"path":"dotnet-api/connecting-to-a-server.md","documentation":{"remote":{"path":"dotnet-api/connecting-to-a-server.md","branch":"swagger-docfx","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0,"endLine":0,"isExternal":false},"_docfxVersion":"2.31.0.0","_systemKeys":["conceptual","type","source","path","documentation","title","rawTitle","wordCount"],"title":"Connecting to a Server","rawTitle":"<h1 id=\"connecting-to-a-server\" sourcefile=\"dotnet-api/connecting-to-a-server.md\" sourcestartlinenumber=\"6\" sourceendlinenumber=\"6\">Connecting to a Server</h1>","section":".NET API","version":"4.0.2","wordCount":1937,"_lang":"csharp","_tocPath":"docs/toc.html","_rel":"../../","_path":"docs/dotnet-api/connecting-to-a-server.html","_key":"dotnet-api/connecting-to-a-server.md","_tocRel":"../toc.html","_tocKey":"~/toc.md","__global":{"classesInSubtitle":"Classes","structsInSubtitle":"Structs","interfacesInSubtitle":"Interfaces","enumsInSubtitle":"Enums","delegatesInSubtitle":"Delegates","constructorsInSubtitle":"Constructors","fieldsInSubtitle":"Fields","propertiesInSubtitle":"Properties","methodsInSubtitle":"Methods","eventsInSubtitle":"Events","operatorsInSubtitle":"Operators","eiisInSubtitle":"Explicit Interface Implementations","functionsInSubtitle":"Functions","membersInSubtitle":"Members","improveThisDoc":"Improve this Doc","viewSource":"View Source","inheritance":"Inheritance","inheritedMembers":"Inherited Members","namespace":"Namespace","assembly":"Assembly","syntax":"Syntax","overrides":"Overrides","implements":"Implements","remarks":"Remarks","examples":"Examples","seealso":"See Also","declaration":"Declaration","parameters":"Parameters","typeParameters":"Type Parameters","type":"Type","name":"Name","description":"Description","returns":"Returns","fieldValue":"Field Value","propertyValue":"Property Value","eventType":"Event Type","exceptions":"Exceptions","condition":"Condition","extensionMethods":"Extension Methods","note":"<h5>Note</h5>","warning":"<h5>Warning</h5>","tip":"<h5>Tip</h5>","important":"<h5>Important</h5>","caution":"<h5>Caution</h5>","_shared":{}}}