{"conceptual":"\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"6\" sourceendlinenumber=\"6\">You write to a stream over HTTP using a <code>POST</code> request to the resource of the stream. If the stream does not exist then the stream will be implicitly created.</p>\n<h2 id=\"single-event\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"8\" sourceendlinenumber=\"8\">Single Event</h2>\n<div class=\"NOTE\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"10\" sourceendlinenumber=\"10\"><h5>Note</h5><p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"11\" sourceendlinenumber=\"13\">Writing a single event has changed from Event Store 2.X.X to Event Store 3.X.X.\nIn Event Store 3.X.X a post of <code>application/json</code> assumes the post data to be the actual event.\nWhen you need to write multiple events, use <code>application/vnd.eventstore.events+json</code> instead.</p>\n</div>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"15\" sourceendlinenumber=\"15\">Issuing a <code>POST</code> request with the data below to a stream, with the correct content type set, will result in writing the event to the stream, and a <code>201</code> response from the server, giving you the location of the event.</p>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"17\" sourceendlinenumber=\"17\">In a file named <em>myevent.txt</em></p>\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"19\" sourceendlinenumber=\"27\"><code class=\"lang-json\">[\n  {\n    &quot;eventId&quot;: &quot;fbf4a1a1-b4a3-4dfe-a01f-ec52c34e16e4&quot;,\n    &quot;eventType&quot;: &quot;event-type&quot;,\n    &quot;data&quot;: { &quot;a&quot;: &quot;1&quot; }\n  }\n]\n</code></pre><p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"29\" sourceendlinenumber=\"29\"><code>POST</code> the following request:</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"31\" sourceendlinenumber=\"53\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"31\" sourceendlinenumber=\"31\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"37\" sourceendlinenumber=\"37\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"33\" sourceendlinenumber=\"35\"><code class=\"lang-bash\">curl -i -d @myevent.txt &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot; -H &quot;ES-EventType: SomeEvent&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"39\" sourceendlinenumber=\"51\"><code class=\"lang-http\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER, Authorization, ES-LongPoll, ES-ExpectedVersion, ES-EventId, ES-EventType, ES-RequiresMaster, ES-HardDelete, ES-ResolveLinkTo, ES-ExpectedVersion\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nLocation: http://127.0.0.1:2113/streams/newstream2/0\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Thu, 29 Jan 2015 14:28:05 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"55\" sourceendlinenumber=\"55\">The event will be available in the stream. Some clients may not be able to generate a GUID (or may not want to generate a GUID) for the ID. You need this ID for idempotence purposes but the server can generate it for you. If we were to leave off the <code>ES-EventId</code> header you would see different behavior:</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"57\" sourceendlinenumber=\"79\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-1_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-1_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"57\" sourceendlinenumber=\"57\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-1_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-1_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"63\" sourceendlinenumber=\"63\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-1_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"59\" sourceendlinenumber=\"61\"><code class=\"lang-bash\">curl -i -d @myevent.txt &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot; -H &quot;ES-EventType: SomeEvent&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-1_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"65\" sourceendlinenumber=\"77\"><code class=\"lang-http\">HTTP/1.1 301 FOUND\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER, Authorization, ES-LongPoll\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nLocation: http://127.0.0.1:2113/streams/newstream/incoming/ad1c1288-0d61-4995-88b2-06c57a42495b\nContent-Type: ; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Mon, 21 Apr 2014 21:01:29 GMT\nContent-Length: 28\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"81\" sourceendlinenumber=\"81\">In this case Event Store has responded with a <code>301 redirect</code>. The location points to another URI that you can post the event to. This new URI will be idempotent for posting to even without an event ID.</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-2\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"83\" sourceendlinenumber=\"105\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-2_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-2_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"83\" sourceendlinenumber=\"83\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-2_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-2_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"89\" sourceendlinenumber=\"89\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-2_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"85\" sourceendlinenumber=\"87\"><code class=\"lang-bash\">curl -i -d @myevent.txt &quot;http://127.0.0.1:2113/streams/newstream/incoming/ad1c1288-0d61-4995-88b2-06c57a42495b&quot; -H &quot;Content-Type: application/json&quot; -H &quot;ES-EventType: SomeEvent&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-2_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"91\" sourceendlinenumber=\"103\"><code class=\"lang-http\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER, Authorization, ES-LongPoll\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nLocation: http://127.0.0.1:2113/streams/newstream/0\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Mon, 21 Apr 2014 21:15:33 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"107\" sourceendlinenumber=\"107\">It is generally recommended to include an event ID if possible as it will result in fewer round trips between the client and the server.</p>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"109\" sourceendlinenumber=\"109\">When posting to either the stream or to the returned redirect clients must include the <code>EventType</code> header. If you forget to include the header you will receive an error.</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-3\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"111\" sourceendlinenumber=\"132\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-3_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-3_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"111\" sourceendlinenumber=\"111\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-3_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-3_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"117\" sourceendlinenumber=\"117\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-3_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"113\" sourceendlinenumber=\"115\"><code class=\"lang-bash\">curl -i -d @myevent.txt &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-3_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"119\" sourceendlinenumber=\"130\"><code class=\"lang-http\">HTTP/1.1 400 Must include an event type with the request either in body or as ES-EventType header.\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER, Authorization, ES-LongPoll\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nContent-Type:\nServer: Mono-HTTPAPI/1.0\nDate: Mon, 21 Apr 2014 21:05:45 GMT\nContent-Length: 0\nConnection: close\n</code></pre></section>\n</div>\n<h2 id=\"event-store-events-media-type\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"134\" sourceendlinenumber=\"134\">Event Store Events Media Type</h2>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"136\" sourceendlinenumber=\"136\">Event store supports a custom media type for posting events <code>application/vnd.eventstore.events (+json/+xml)</code>. This format allows for extra functionality that posting events as above does not. For example it allows you to post multiple events in a single batch.</p>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"138\" sourceendlinenumber=\"138\">In a file named <em>simple-event.txt</em>:</p>\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"140\" sourceendlinenumber=\"148\"><code class=\"lang-json\">[\n  {\n    &quot;eventId&quot;: &quot;fbf4a1a1-b4a3-4dfe-a01f-ec52c34e16e4&quot;,\n    &quot;eventType&quot;: &quot;event-type&quot;,\n    &quot;data&quot;: { &quot;a&quot;: &quot;1&quot; }\n  }\n]\n</code></pre><p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"150\" sourceendlinenumber=\"150\">The data is represented by the following jschema (<code>eventId</code> must be a UUID).</p>\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"152\" sourceendlinenumber=\"161\"><code class=\"lang-json\">[\n    {\n      &quot;eventId&quot;    : &quot;string&quot;,\n      &quot;eventType&quot;  : &quot;string&quot;,\n      &quot;data&quot;       : &quot;object&quot;,\n      &quot;metadata&quot;   : &quot;object&quot;\n    }\n]\n</code></pre><h3 id=\"create-a-stream\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"163\" sourceendlinenumber=\"163\">Create a Stream</h3>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"165\" sourceendlinenumber=\"165\">To create a stream, issue a <code>POST</code> request to the <code>/streams/newstream</code> resource:</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-4\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"167\" sourceendlinenumber=\"188\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-4_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-4_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"167\" sourceendlinenumber=\"167\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-4_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-4_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"173\" sourceendlinenumber=\"173\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-4_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"169\" sourceendlinenumber=\"171\"><code class=\"lang-bash\">curl -i -d @event.txt &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/vnd.eventstore.events+json&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-4_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"175\" sourceendlinenumber=\"186\"><code class=\"lang-http\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER\nAccess-Control-Allow-Origin: *\nLocation: http://127.0.0.1:2113/streams/newstream/0\nContent-Type: text/plain; charset: utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Fri, 28 Jun 2013 12:17:59 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<h3 id=\"appending-events\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"190\" sourceendlinenumber=\"190\">Appending Events</h3>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"192\" sourceendlinenumber=\"192\">To append events, issue a <code>POST</code> request to the same resource again and edit the message ID GUID:</p>\n<!-- TODO: This doesn't show that -->\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-5\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"196\" sourceendlinenumber=\"217\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-5_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-5_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"196\" sourceendlinenumber=\"196\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-5_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-5_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"202\" sourceendlinenumber=\"202\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-5_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"198\" sourceendlinenumber=\"200\"><code class=\"lang-bash\">curl -i -d @event.txt &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/vnd.eventstore.events+json&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-5_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"204\" sourceendlinenumber=\"215\"><code class=\"lang-http\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER\nAccess-Control-Allow-Origin: *\nLocation: http://127.0.0.1:2113/streams/newstream/1\nContent-Type: text/plain; charset: utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Fri, 28 Jun 2013 12:32:18 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<h3 id=\"data-only-events\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"219\" sourceendlinenumber=\"219\">Data only events</h3>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"221\" sourceendlinenumber=\"221\">Version 3.7.0 of Event Store added support for the <code>application/octet-stream</code> content type to support data only events. When creating these events, you will need to provide the <code>ES-EventType</code> and <code>ES-EventId</code> headers and cannot have metadata associated with the Event. In the example below <code>SGVsbG8gV29ybGQ=</code> is the data you <code>POST</code> to the stream:</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-6\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"223\" sourceendlinenumber=\"245\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-6_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-6_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"223\" sourceendlinenumber=\"223\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-6_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-6_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"229\" sourceendlinenumber=\"229\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-6_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"225\" sourceendlinenumber=\"227\"><code class=\"lang-bash\">curl -i -d &quot;SGVsbG8gV29ybGQ=&quot; &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/octet-stream&quot; -H &quot;ES-EventType:rawDataType&quot; -H &quot;ES-EventId:eeccf3ce-4f54-409d-8870-b35dd836cca6&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-6_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"231\" sourceendlinenumber=\"243\"><code class=\"lang-http\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-Forwarded-Host, X-PINGOTHER, Authorization, ES-LongPoll, ES-ExpectedVersion, ES-EventId, ES-EventType, ES-RequiresMaster, ES-HardDelete, ES-ResolveLinkTo, ES-ExpectedVersion\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nLocation: http://127.0.0.1:2113/streams/newstream/0\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Mon, 27 Jun 2016 13:15:27 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<h2 id=\"expected-version\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"247\" sourceendlinenumber=\"247\">Expected Version</h2>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"249\" sourceendlinenumber=\"249\">The expected version header is a number representing the version of the stream you read from. For example if you read from the stream and it was at version 5 then you expect it to be at version 5. This can allow for optimistic locking when multiple applications are reading/writing to streams. If your expected version is not the current version you will receive a HTTP status code of 400.</p>\n<div class=\"NOTE\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"251\" sourceendlinenumber=\"251\"><h5>Note</h5><p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"253\" sourceendlinenumber=\"253\">See the idempotency section below, if you post the same event twice it will be idempotent and will not give a version error.</p>\n</div>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-7\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"255\" sourceendlinenumber=\"275\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-7_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-7_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"255\" sourceendlinenumber=\"255\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-7_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-7_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"261\" sourceendlinenumber=\"261\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-7_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"257\" sourceendlinenumber=\"259\"><code class=\"lang-bash\">curl -i -d @event.txt &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot; -H &quot;ES-ExpectedVersion: 3&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-7_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"263\" sourceendlinenumber=\"273\"><code class=\"lang-http\">HTTP/1.1 400 Wrong expected EventNumber\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER\nAccess-Control-Allow-Origin: *\nContent-Type: text/plain; charset: utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Fri, 28 Jun 2013 12:33:30 GMT\nContent-Length: 0\nConnection: close\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"277\" sourceendlinenumber=\"277\">There are some special values you can put into the expected version header.</p>\n<ul sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"279\" sourceendlinenumber=\"281\">\n<li sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"279\" sourceendlinenumber=\"279\"><code>-2</code> states that this write should never conflict and should always succeed.</li>\n<li sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"280\" sourceendlinenumber=\"280\"><code>-1</code> states that the stream should not exist at the time of the writing (this write will create it).</li>\n<li sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"281\" sourceendlinenumber=\"281\"><code>0</code> states that the stream should exist but should be empty.</li>\n</ul>\n<h2 id=\"batch-writes\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"283\" sourceendlinenumber=\"283\">Batch Writes</h2>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"285\" sourceendlinenumber=\"285\">You can include more than one write in a single post by placing multiple events inside of the array representing the events, you can include metadata.</p>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"287\" sourceendlinenumber=\"287\">The following post body inserts two events:</p>\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"289\" sourceendlinenumber=\"308\"><code class=\"lang-json\">[\n  {\n    &quot;eventId&quot;: &quot;fbf4b1a1-b4a3-4dfe-a01f-ec52c34e16e4&quot;,\n    &quot;eventType&quot;: &quot;event-type&quot;,\n    &quot;data&quot;: {\n\n      &quot;a&quot;: &quot;1&quot;\n    }\n  },\n  {\n    &quot;eventId&quot;: &quot;0f9fad5b-d9cb-469f-a165-70867728951e&quot;,\n    &quot;eventType&quot;: &quot;event-type&quot;,\n    &quot;data&quot;: {\n\n      &quot;a&quot;: &quot;1&quot;\n    }\n  }\n]\n</code></pre><p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"310\" sourceendlinenumber=\"310\">When you write multiple events in a single post, Event Store treats them transactionally, it writes all events together or all will fail.</p>\n<h3 id=\"idempotency\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"312\" sourceendlinenumber=\"312\">Idempotency</h3>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"314\" sourceendlinenumber=\"314\">Appends to streams are idempotent based upon the <code>EventId</code> assigned in your post. If you were to re-run the last cURL command it will return the same value again.</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-8\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"316\" sourceendlinenumber=\"337\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-8_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-8_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"316\" sourceendlinenumber=\"316\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-8_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-8_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"322\" sourceendlinenumber=\"322\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-8_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"318\" sourceendlinenumber=\"320\"><code class=\"lang-bash\">curl -i -d @event.txt &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-8_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"324\" sourceendlinenumber=\"335\"><code class=\"lang-http\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: DELETE, GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER\nAccess-Control-Allow-Origin: *\nLocation: http://127.0.0.1:2113/streams/newstream/2\nContent-Type: ; charset: utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Wed, 03 Apr 2013 15:21:53 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"339\" sourceendlinenumber=\"339\">This is important behaviour as this is how you implement error handling. If you receive a timeout, broken connection, no answer, etc from your HTTP <code>POST</code> then it&#39;s your responsibility is to retry the post. You must also keep the same <code>uuid</code> that you assigned to the event in the first <code>POST</code>.</p>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"341\" sourceendlinenumber=\"341\">If you are using the expected version parameter with your message, then Event Store is 100% idempotent. If you use <code>Any</code> as your expected version value, Event Store will do its best to keep events idempotent but cannot assure that everything is fully idempotent and you will end up in &#39;at-least-once&#39; messaging. <a href=\"~/http-api/optimistic-concurrency-and-idempotence.md\" data-raw-source=\"[Read this guide](~/http-api/optimistic-concurrency-and-idempotence.md)\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"341\" sourceendlinenumber=\"341\">Read this guide</a> for more details on idempotency.</p>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"343\" sourceendlinenumber=\"343\">This idempotency also applies to the URIs generated by the server if you post a body as an event without the <code>ES-EventId</code> header associated with the request:</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-9\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"345\" sourceendlinenumber=\"367\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-9_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-9_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"345\" sourceendlinenumber=\"345\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-9_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-9_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"351\" sourceendlinenumber=\"351\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-9_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"347\" sourceendlinenumber=\"349\"><code class=\"lang-bash\">curl -i -d @event.txt &quot;http://127.0.0.1:2113/streams/newstream&quot; -H &quot;Content-Type:application/json&quot; -H &quot;ES-EventType: SomeEvent&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-9_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"353\" sourceendlinenumber=\"365\"><code class=\"lang-http\">HTTP/1.1 301 FOUND\nAccess-Control-Allow-Methods: POST, DELETE, GET, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER, Authorization, ES-LongPoll\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nLocation: http://127.0.0.1:2113/streams/newstream/incoming/c7248fc1-3db4-42c1-96aa-a071c92649d1\nContent-Type: ; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Mon, 21 Apr 2014 21:11:59 GMT\nContent-Length: 28\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"369\" sourceendlinenumber=\"369\">You can then post multiple times to the generated redirect URI and Event Store will make the requests will idempotent for you:</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-10\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"371\" sourceendlinenumber=\"393\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-10_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-10_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"371\" sourceendlinenumber=\"371\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-10_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-10_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"377\" sourceendlinenumber=\"377\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-10_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"373\" sourceendlinenumber=\"375\"><code class=\"lang-bash\">curl -i -d @event.txt &quot;http://127.0.0.1:2113/streams/newstream/incoming/c7248fc1-3db4-42c1-96aa-a071c92649d1&quot; -H &quot;Content-Type: application/json&quot; -H &quot;ES-EventType: SomeEvent&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-10_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"379\" sourceendlinenumber=\"391\"><code class=\"lang-http\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER, Authorization, ES-LongPoll\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nLocation: http://127.0.0.1:2113/streams/newstream/0\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Mon, 21 Apr 2014 21:14:28 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n<p sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"395\" sourceendlinenumber=\"395\">If you retry the post:</p>\n<div class=\"tabGroup\" id=\"tabgroup_fK0ltPcWWL-11\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"397\" sourceendlinenumber=\"419\">\n<ul role=\"tablist\">\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-11_tabid-1\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-11_tabid-1\" data-tab=\"tabid-1\" tabindex=\"0\" aria-selected=\"true\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"397\" sourceendlinenumber=\"397\">Request</a>\n</li>\n<li role=\"presentation\">\n<a href=\"#tabpanel_fK0ltPcWWL-11_tabid-2\" role=\"tab\" aria-controls=\"tabpanel_fK0ltPcWWL-11_tabid-2\" data-tab=\"tabid-2\" tabindex=\"-1\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"403\" sourceendlinenumber=\"403\">Response</a>\n</li>\n</ul>\n<section id=\"tabpanel_fK0ltPcWWL-11_tabid-1\" role=\"tabpanel\" data-tab=\"tabid-1\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"399\" sourceendlinenumber=\"401\"><code class=\"lang-bash\">curl -i -d @event.txt &quot;http://127.0.0.1:2113/streams/newstream/incoming/c7248fc1-3db4-42c1-96aa-a071c92649d1&quot; -H &quot;Content-Type: application/json&quot; -H &quot;ES-EventType: SomeEvent&quot;\n</code></pre></section>\n<section id=\"tabpanel_fK0ltPcWWL-11_tabid-2\" role=\"tabpanel\" data-tab=\"tabid-2\" aria-hidden=\"true\" hidden=\"hidden\">\n<pre sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"405\" sourceendlinenumber=\"417\"><code class=\"lang-http\">HTTP/1.1 201 Created\nAccess-Control-Allow-Methods: GET, POST, OPTIONS\nAccess-Control-Allow-Headers: Content-Type, X-Requested-With, X-PINGOTHER, Authorization, ES-LongPoll\nAccess-Control-Allow-Origin: *\nAccess-Control-Expose-Headers: Location, ES-Position\nLocation: http://127.0.0.1:2113/streams/newstream/0\nContent-Type: text/plain; charset=utf-8\nServer: Mono-HTTPAPI/1.0\nDate: Mon, 21 Apr 2014 21:15:33 GMT\nContent-Length: 0\nKeep-Alive: timeout=15,max=100\n</code></pre></section>\n</div>\n","type":"Conceptual","source":{"remote":{"path":"http-api/writing-to-a-stream.md","branch":"swagger-docfx","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0,"endLine":0,"isExternal":false},"path":"http-api/writing-to-a-stream.md","documentation":{"remote":{"path":"http-api/writing-to-a-stream.md","branch":"swagger-docfx","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0,"endLine":0,"isExternal":false},"_docfxVersion":"2.31.0.0","_systemKeys":["conceptual","type","source","path","documentation","title","rawTitle","wordCount"],"title":"Writing to a Stream","rawTitle":"<h1 id=\"writing-to-a-stream\" sourcefile=\"http-api/writing-to-a-stream.md\" sourcestartlinenumber=\"4\" sourceendlinenumber=\"4\">Writing to a Stream</h1>","uid":"eventstore.org/Event Store HTTP API/4.0.2/createStream","wordCount":1473,"_lang":"csharp","_tocPath":"docs/toc.html","_rel":"../../","_path":"docs/http-api/writing-to-a-stream.html","_key":"http-api/writing-to-a-stream.md","_tocRel":"../toc.html","_tocKey":"~/toc.md","__global":{"classesInSubtitle":"Classes","structsInSubtitle":"Structs","interfacesInSubtitle":"Interfaces","enumsInSubtitle":"Enums","delegatesInSubtitle":"Delegates","constructorsInSubtitle":"Constructors","fieldsInSubtitle":"Fields","propertiesInSubtitle":"Properties","methodsInSubtitle":"Methods","eventsInSubtitle":"Events","operatorsInSubtitle":"Operators","eiisInSubtitle":"Explicit Interface Implementations","functionsInSubtitle":"Functions","membersInSubtitle":"Members","improveThisDoc":"Improve this Doc","viewSource":"View Source","inheritance":"Inheritance","inheritedMembers":"Inherited Members","namespace":"Namespace","assembly":"Assembly","syntax":"Syntax","overrides":"Overrides","implements":"Implements","remarks":"Remarks","examples":"Examples","seealso":"See Also","declaration":"Declaration","parameters":"Parameters","typeParameters":"Type Parameters","type":"Type","name":"Name","description":"Description","returns":"Returns","fieldValue":"Field Value","propertyValue":"Property Value","eventType":"Event Type","exceptions":"Exceptions","condition":"Condition","extensionMethods":"Extension Methods","note":"<h5>Note</h5>","warning":"<h5>Warning</h5>","tip":"<h5>Tip</h5>","important":"<h5>Important</h5>","caution":"<h5>Caution</h5>","_shared":{}}}