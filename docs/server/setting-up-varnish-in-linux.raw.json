{"conceptual":"\n<p sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"3\" sourceendlinenumber=\"3\">This document provides a brief guide on how to install Event Store with the varnish reverse proxy in a Linux environment. For more information on how to properly configure varnish for your requirements, read the <a href=\"https://www.varnish-cache.org/trac/wiki/Introduction\" data-raw-source=\"[Varnish documentation](https://www.varnish-cache.org/trac/wiki/Introduction)\" sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"3\" sourceendlinenumber=\"3\">Varnish documentation</a>.</p>\n<p sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"5\" sourceendlinenumber=\"5\">You use a reverse proxy to limit access to Event Store without breaking HTTP caching (authenticate to the proxy not to Event Store itself). Since Event Store runs HTTP only on the loopback adapter, users must enter through the reverse proxy to reach Event Store. <a href=\"https://gist.github.com/benclark/2695148\" data-raw-source=\"[Ben Clark&#8217;s Gist](https://gist.github.com/benclark/2695148)\" sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"5\" sourceendlinenumber=\"5\">Ben Clarkâ€™s Gist</a> contains a more configured varnish configuration that includes basic authentication as well as some other niceties such as adding headers for hits/misses).</p>\n<p sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"7\" sourceendlinenumber=\"7\">The first thing that we will need to do is to install varnish</p>\n<pre sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"9\" sourceendlinenumber=\"14\"><code class=\"lang-bash\">sudo curl http://repo.varnish-cache.org/debian/GPG-key.txt | sudo apt-key add -\necho &quot;deb http://repo.varnish-cache.org/ubuntu/ precise varnish-3.0&quot; | sudo tee -a /etc/apt/sources.list\nsudo apt-get update\nsudo apt-get install varnish\n</code></pre><p sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"16\" sourceendlinenumber=\"16\">Next configure varnish.</p>\n<pre sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"18\" sourceendlinenumber=\"20\"><code class=\"lang-bash\">sudo vi /etc/default/varnish\n</code></pre><p sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"22\" sourceendlinenumber=\"22\">Edit the section that looks like:</p>\n<pre sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"24\" sourceendlinenumber=\"30\"><code class=\"lang-bash\">DAEMON_OPTS=&quot;-a :80 \\\n             -T localhost:6082 \\\n             -f /etc/varnish/default.vcl \\\n             -S /etc/varnish/secret \\\n             -s malloc,256m&quot;\n</code></pre><p sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"32\" sourceendlinenumber=\"32\">Replace the port with the port you want to run on:</p>\n<pre sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"34\" sourceendlinenumber=\"36\"><code class=\"lang-bash\">sudo vi /etc/varnish/default.vcl\n</code></pre><p sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"38\" sourceendlinenumber=\"38\">Set it to:</p>\n<pre sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"45\"><code class=\"lang-bash\">backend default {\n    .host = &quot;127.0.0.1&quot;;\n    .port = &quot;2114&quot;;\n}\n</code></pre><p sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"47\" sourceendlinenumber=\"47\">Finally use <code>sudo service varnish restart</code> to restart varnish and Event Store should berunning with a reverse proxy. If you want to check out the status of varnish you can check with <code>varnishstat</code> from the command line.</p>\n","type":"Conceptual","source":{"remote":{"path":"server/setting-up-varnish-in-linux.md","branch":"swagger-docfx","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0,"endLine":0,"isExternal":false},"path":"server/setting-up-varnish-in-linux.md","documentation":{"remote":{"path":"server/setting-up-varnish-in-linux.md","branch":"swagger-docfx","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0,"endLine":0,"isExternal":false},"_docfxVersion":"2.31.0.0","_systemKeys":["conceptual","type","source","path","documentation","title","rawTitle","wordCount"],"title":"Setting up Varnish in Linux","rawTitle":"<h1 id=\"setting-up-varnish-in-linux\" sourcefile=\"server/setting-up-varnish-in-linux.md\" sourcestartlinenumber=\"1\" sourceendlinenumber=\"1\">Setting up Varnish in Linux</h1>","wordCount":235,"_lang":"csharp","_tocPath":"docs/toc.html","_rel":"../../","_path":"docs/server/setting-up-varnish-in-linux.html","_key":"server/setting-up-varnish-in-linux.md","_tocRel":"../toc.html","_tocKey":"~/toc.md","__global":{"classesInSubtitle":"Classes","structsInSubtitle":"Structs","interfacesInSubtitle":"Interfaces","enumsInSubtitle":"Enums","delegatesInSubtitle":"Delegates","constructorsInSubtitle":"Constructors","fieldsInSubtitle":"Fields","propertiesInSubtitle":"Properties","methodsInSubtitle":"Methods","eventsInSubtitle":"Events","operatorsInSubtitle":"Operators","eiisInSubtitle":"Explicit Interface Implementations","functionsInSubtitle":"Functions","membersInSubtitle":"Members","improveThisDoc":"Improve this Doc","viewSource":"View Source","inheritance":"Inheritance","inheritedMembers":"Inherited Members","namespace":"Namespace","assembly":"Assembly","syntax":"Syntax","overrides":"Overrides","implements":"Implements","remarks":"Remarks","examples":"Examples","seealso":"See Also","declaration":"Declaration","parameters":"Parameters","typeParameters":"Type Parameters","type":"Type","name":"Name","description":"Description","returns":"Returns","fieldValue":"Field Value","propertyValue":"Property Value","eventType":"Event Type","exceptions":"Exceptions","condition":"Condition","extensionMethods":"Extension Methods","note":"<h5>Note</h5>","warning":"<h5>Warning</h5>","tip":"<h5>Tip</h5>","important":"<h5>Important</h5>","caution":"<h5>Caution</h5>","_shared":{}}}