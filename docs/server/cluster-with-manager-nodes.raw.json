{"conceptual":"\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"3\" sourceendlinenumber=\"3\">High availability Event Store allows you to run more than one node as a cluster. There are two modes available for clustering:</p>\n<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"5\" sourceendlinenumber=\"6\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"5\" sourceendlinenumber=\"5\">With database nodes only (open source and commercial)</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"6\" sourceendlinenumber=\"6\">With manager nodes and database nodes (commercial only)</li>\n</ul>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"8\" sourceendlinenumber=\"8\">This document covers setting up Event Store with manager nodes and database nodes.</p>\n<h2 id=\"manager-nodes\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"10\" sourceendlinenumber=\"10\">Manager Nodes</h2>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"12\" sourceendlinenumber=\"12\">Each physical (or virtual) machine in an Event Store cluster typically runs one manager node and one database node. It is also possible to have multiple database nodes per physical machine, running under one manager node.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"14\" sourceendlinenumber=\"14\">Manager nodes have a number of responsibilities:</p>\n<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"16\" sourceendlinenumber=\"19\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"16\" sourceendlinenumber=\"16\">They are responsible for starting the database nodes and supervising them to ensure they are restarted in case of a crash or termination owing to abnormal circumstances. This is known as the <em>watchdog</em> service.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"17\" sourceendlinenumber=\"17\">They communicate with other manager nodes to determine cluster state, and relay that information to the database nodes under management.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"18\" sourceendlinenumber=\"18\">They provide a known endpoint for clients to connect to, to discover cluster information.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"19\" sourceendlinenumber=\"19\">When running on Windows, manager nodes run as Windows services.</li>\n</ul>\n<h2 id=\"configuring-nodes\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"21\" sourceendlinenumber=\"21\">Configuring Nodes</h2>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"23\" sourceendlinenumber=\"23\">Each database or manager node can have a variety of configuration sources. Each source has a priority and determines running configuration by evaluating each source and applying the option from the source with the highest priority.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"25\" sourceendlinenumber=\"25\">From lowest to highest priority, the sources of configuration are:</p>\n<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"27\" sourceendlinenumber=\"30\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"27\" sourceendlinenumber=\"27\">Default settings.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"28\" sourceendlinenumber=\"28\">Settings specified in a configuration file written using YAML.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"29\" sourceendlinenumber=\"29\">Settings specified in environment variables.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"30\" sourceendlinenumber=\"30\">Settings specified as command line options to the node.</li>\n</ul>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"32\" sourceendlinenumber=\"32\">You can determine the configuration of a node by passing the <code>-WhatIf</code> flag to the process.</p>\n<h2 id=\"typical-deployment-topologies\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"34\" sourceendlinenumber=\"34\">Typical Deployment Topologies</h2>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"36\" sourceendlinenumber=\"36\">Event Store clusters follow a &quot;shared nothing&quot; philosophy, meaning that clustering requires no shared disks for clustering to work. Instead, several database nodes store your data to ensure it isn&#39;t lost in case of a drive failure or a node crashing.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"38\" sourceendlinenumber=\"38\">Event Store uses a quorum-based replication model, in which a majority of nodes in the cluster must acknowledge that a write has been committed to disk before acknowledging the write to the client. This means that to be able to tolerate the failure of <em>n</em> nodes, the cluster must be of size <em>(2n + 1)</em>. A three-database-node cluster can continue to accept writes in the case that one node is unavailable, a five-database-node cluster can continue to accept writes in the case that two nodes are unavailable, and so forth.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"40\" sourceendlinenumber=\"40\">A typical deployment topology consists of three physical machines, each running one manager node and one database node, as shown in figure 1. Each of the physical machines may have two network interfaces, one for communicating with other cluster members, and one for serving clients. Although it may be preferable in some situations to run over two separate networks, it is also possible to use different TCP ports on one interface.</p>\n<!-- TODO: There is no figure 1? -->\n<h2 id=\"cluster-gossip\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"44\" sourceendlinenumber=\"44\">Cluster gossip</h2>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"46\" sourceendlinenumber=\"46\">Event Store uses a quorum-based replication model. When working normally, a cluster will have one database node which is known as a <em>master</em>, and the remaining nodes will be <em>slaves</em>. The master node is responsible for coordinating writes while it is the master. Database nodes use a consensus algorithm to determine which database node should be master and which should be slaves. Event Store bases the decision as to which node should be the master on a number of factors (some of which are configurable).</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"48\" sourceendlinenumber=\"48\">For database nodes to have this information available to them, the nodes gossip with other nodes in the cluster. Gossip runs over the internal (and optionally the external) HTTP interfaces of database nodes, and over both internal and external interfaces of manager nodes.</p>\n<h2 id=\"discovering-cluster-members\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"50\" sourceendlinenumber=\"50\">Discovering cluster members</h2>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"52\" sourceendlinenumber=\"52\">Manager and database nodes need to know about one another to gossip. To start this process, you provide gossip seeds or the addresses where it can find other nodes, to each node. When running with manager nodes, it normally uses the following approach:</p>\n<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"54\" sourceendlinenumber=\"57\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"54\" sourceendlinenumber=\"54\">On each physical machine, configure the database node(s) with a gossip seed of the internal HTTP interface of the manager running on the same physical machine.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"55\" sourceendlinenumber=\"57\">Configure the managers to discover other managers in one of two ways:<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"56\" sourceendlinenumber=\"57\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"56\" sourceendlinenumber=\"56\">via a DNS entry and a well-known gossip port.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"57\" sourceendlinenumber=\"57\">via a list of other managersâ€™ addresses.</li>\n</ul>\n</li>\n</ul>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"59\" sourceendlinenumber=\"59\">The preferred method is via a DNS entry. To set this up, create a DNS entry for the cluster with an A record pointing to each member of the cluster. Each manager will then look up other nodes in the cluster during the startup process based on the DNS name. Since DNS only provides information about addresses, you need to use a consistent TCP port across the cluster for gossip.</p>\n<h2 id=\"example-1---a-three-machine-cluster\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"61\" sourceendlinenumber=\"61\">Example 1 - A Three-Machine Cluster</h2>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"63\" sourceendlinenumber=\"63\">This example shows the configuration for a three node cluster, running in the typical setup of one manager node and one database node per physical machine, with cluster discovery via DNS. Each machine has one network interface, therefore uses different ports for the internal and external traffic. All nodes, in this case, are running Windows, so the manager nodes will run as Windows services.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"65\" sourceendlinenumber=\"65\">Figure 2 below shows the setup. The important points for writing configuration files are:</p>\n<!-- TODO: Again, no figure? -->\n<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"69\" sourceendlinenumber=\"79\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"69\" sourceendlinenumber=\"69\">Node IP Addresses: 192.168.1.11, 192.168.1.12 and 192.168.13</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"70\" sourceendlinenumber=\"78\">TCP ports: (defaults):<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"71\" sourceendlinenumber=\"78\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"71\" sourceendlinenumber=\"73\">Manager Nodes:<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"72\" sourceendlinenumber=\"73\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"72\" sourceendlinenumber=\"72\">Internal HTTP: 30777</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"73\" sourceendlinenumber=\"73\">External HTTP: 30778</li>\n</ul>\n</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"74\" sourceendlinenumber=\"78\">Database Nodes:<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"75\" sourceendlinenumber=\"78\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"75\" sourceendlinenumber=\"75\">Internal TCP: 1112</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"76\" sourceendlinenumber=\"76\">External TCP: 1113</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"77\" sourceendlinenumber=\"77\">Internal HTTP: 2112</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"78\" sourceendlinenumber=\"78\">External HTTP: 2113</li>\n</ul>\n</li>\n</ul>\n</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"79\" sourceendlinenumber=\"79\">DNS Entry Name: cluster1.eventstore.local</li>\n</ul>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"81\" sourceendlinenumber=\"81\">To configure the cluster correctly, there are a number of steps to follow:</p>\n<ol sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"83\" sourceendlinenumber=\"90\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"83\" sourceendlinenumber=\"83\">Set up a DNS entry named <code>cluster1.eventstore.local</code> with an A record for each node.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"84\" sourceendlinenumber=\"84\">Write the database node configuration file for each machine.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"85\" sourceendlinenumber=\"85\">Write the manager node configuration file for each machine.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"86\" sourceendlinenumber=\"86\">Write the watchdog configuration file for each machine.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"87\" sourceendlinenumber=\"87\">Deploy Event Store and the configuration files to each machine.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"88\" sourceendlinenumber=\"88\">(<strong>Windows-specific</strong>) Add HTTP URL ACL entries to allow starting HTTP servers on the required HTTP ports.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"89\" sourceendlinenumber=\"89\">(<strong>Windows-specific</strong>) Install the manager as a service and start the service.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"90\" sourceendlinenumber=\"90\">(<strong>Linux-specific</strong>) Configure the manager as a daemon.</li>\n</ol>\n<h3 id=\"dns-entry\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"92\" sourceendlinenumber=\"92\">DNS entry</h3>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"94\" sourceendlinenumber=\"94\">HIt depends on which DNS server is in use, but the eventual lookup should read:</p>\n<pre sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"96\" sourceendlinenumber=\"107\"><code class=\"lang-bash\">nslookup cluster1.eventstore.local\n\nServer: 192.168.1.2\nAddress:  192.168.1.2#53\nName: cluster.eventstore.local\nAddress:  192.168.1.11\nName: cluster.eventstore.local\nAddress:  192.168.1.12\nName: cluster.eventstore.local\nAddress:  192.168.1.13\n</code></pre><h3 id=\"database-node-configuration\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"109\" sourceendlinenumber=\"109\">Database Node Configuration</h3>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"111\" sourceendlinenumber=\"111\">All three nodes will be similar in configuration. The important configuration points are IP Addresses for internal and external interfaces, the ports for each endpoint, the location of the database file, the size of the cluster and the endpoints from which to seed gossip (in this case the local manager). We assume in this case that Event Store stores data on the _D:_ drive.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"113\" sourceendlinenumber=\"113\">The configuration files are written in YAML, and reads as follows for the first node:</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"115\" sourceendlinenumber=\"115\">Filename : <em>database.yaml</em></p>\n<pre sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"117\" sourceendlinenumber=\"128\"><code class=\"lang-yaml\">Db: d:\\es-data\nIntIp: 192.168.1.11\nExtIp: 192.168.1.11\nIntTcpPort: 1112\nIntHttpPort: 2112\nExtTcpPort: 1113\nExtHttpPort: 2113\nDiscoverViaDns: false\nGossipSeed: [&#39;192.168.1.11:30777&#39;]\nClusterSize: 3\n</code></pre><p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"130\" sourceendlinenumber=\"130\">For each subsequent node, the IP Addresses change, as does the gossip seed (since it is the manager running on the same physical machine as each node).</p>\n<h3 id=\"manager-configuration\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"132\" sourceendlinenumber=\"132\">Manager Configuration</h3>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"134\" sourceendlinenumber=\"134\">Again, all three nodes will be similar in configuration. The important configuration points are the IP addresses for the internal and external interfaces, the ports for the HTTP endpoints, the log location, and the DNS information about other nodes. Another important piece of configuration is which database nodes the manager is responsible for starting. This is defined in a separate file (the watchdog configuration), the path to which is specified as <code>WatchdogConfig</code> in the manager configuration.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"136\" sourceendlinenumber=\"136\">The configuration files are written in YAML, and for the first node reads as follows:</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"138\" sourceendlinenumber=\"138\">Filename: <em>manager.yaml</em></p>\n<pre sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"140\" sourceendlinenumber=\"151\"><code class=\"lang-yaml\">IntIp: 192.168.1.11\nExtIp: 192.168.1.11\nIntHttpPort: 30777\nExtHttpPort: 30778\nDiscoverViaDns: true\nClusterDns: cluster1.eventstore.local\nClusterGossipPort: 30777\nEnableWatchdog: true\nWatchdogConfig: c:\\EventStore-Config\\watchdog.esconfig\nLog: d:\\manager-log\n</code></pre><h3 id=\"watchdog-configuration\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"153\" sourceendlinenumber=\"153\">Watchdog Configuration</h3>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"155\" sourceendlinenumber=\"155\">The watchdog configuration file details which database nodes the manager is responsible for starting and supervising. Unlike the other configuration files, the manager configuration uses a custom format instead of YAML. Each node for which the manager is responsible has one line in the file, which starts with a <code>#</code> symbol and then details the command line options given to the database node when it is started. Under normal circumstances, this will be the path to the database nodeâ€™s configuration file.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"157\" sourceendlinenumber=\"157\">For the first node in the example cluster, the watchdog configuration file reads as follows:</p>\n<pre sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"159\" sourceendlinenumber=\"161\"><code class=\"lang-text\"># --config c:\\EventStore-Config\\database.yaml\n</code></pre><h3 id=\"deploying-event-store-software-and-configuration\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"163\" sourceendlinenumber=\"163\">Deploying Event Store software and configuration</h3>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"165\" sourceendlinenumber=\"165\">Having written configuration files for each node, you can now deploy Event Store and configuration. Although it is possible to use relative paths when writing configuration files, it is preferable to use absolute paths to reduce the potential for confusion.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"167\" sourceendlinenumber=\"167\">In this case, Event Store is deployed on each node in _c:\\EventStore-HA-v3.0.1_, and the configuration files for that node are deployed into _C:\\EventStore-Config_. No installation process is necessary, the packaged distribution can be unzipped, assuming they have been unblocked following download.</p>\n<h3 id=\"adding-http-acl-entries-for-http-servers-windows-specific\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"169\" sourceendlinenumber=\"169\">Adding HTTP ACL entries for HTTP servers (Windows-Specific)</h3>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"171\" sourceendlinenumber=\"171\">To allow for non-elevated users to run HTTP servers on Windows, you must add entries to the access control list using <code>netsh</code>. By default, the manager node runs as <code>NT AUTHORITY\\Local Service</code>, so this is the user who must have permission to run the HTTP server.</p>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"173\" sourceendlinenumber=\"173\">The commands used to add these entries on node one are as follows (Run as an elevated user):</p>\n<pre sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"175\" sourceendlinenumber=\"187\"><code class=\"lang-powershell\"># Database Node Internal HTTP Interface\nnetsh http add urlacl url=http://192.168.1.11:2112/ user=&quot;NT AUTHORITY\\LOCAL SERVICE&quot;\n\n# Database Node External HTTP Interface\nnetsh http add urlacl url=http://192.168.1.11:2113/ user=&quot;NT AUTHORITY\\LOCAL SERVICE&quot;\n\n# Manager Node Internal HTTP Interface\nnetsh http add urlacl url=http://192.168.1.11:30777/ user=&quot;NT AUTHORITY\\LOCAL SERVICE&quot;\n\n# Manager Node External HTTP Interface\nnetsh http add urlacl url=http://192.168.1.11:30778/ user=&quot;NT AUTHORITY\\LOCAL SERVICE&quot;\n</code></pre><h3 id=\"configure-the-manager-node-as-a-service-windows-specific\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"189\" sourceendlinenumber=\"189\">Configure the Manager Node as a service (Windows-Specific)</h3>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"191\" sourceendlinenumber=\"191\">You can install manager nodes as a Windows service, so they can start on boot rather than running in interactive mode. Each manager service is given an instance name, which becomes the name of the service (and part of the description for easy identification). The service is installed by default with a startup type of &quot;Automatic (Delayed Start)&quot;.</p>\n<h4 id=\"installing-the-service\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"193\" sourceendlinenumber=\"193\">Installing the service</h4>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"195\" sourceendlinenumber=\"195\">To install the manager node on machine 1, use the following command is:</p>\n<pre sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"197\" sourceendlinenumber=\"200\"><code class=\"lang-powershell\">C:\\EventStore-HA-v3.0.1\\&gt; EventStore.WindowsManager.exe install -InstanceName es-cluster1 -ManagerConfig\nC:\\EventStore-Config\\manager.yaml\n</code></pre><p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"202\" sourceendlinenumber=\"202\">The service will then be visible in the services list, with a description of &quot;Event Store Manager (es-cluster1)&quot;.</p>\n<h4 id=\"uninstalling-the-service\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"204\" sourceendlinenumber=\"204\">Uninstalling the service</h4>\n<p sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"206\" sourceendlinenumber=\"206\">To uninstall the manager node service in future, use the following command (where the instance name matches the name used during installation).</p>\n<pre sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"208\" sourceendlinenumber=\"210\"><code class=\"lang-powershell\">C:\\EventStore-HA-v3.0.1\\&gt; EventStore.WindowsManager.exe uninstall -InstanceName es-cluster1\n</code></pre><h4 id=\"manually-starting-and-stopping-the-service\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"212\" sourceendlinenumber=\"212\">Manually starting and stopping the service</h4>\n<ul sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"214\" sourceendlinenumber=\"215\">\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"214\" sourceendlinenumber=\"214\">To start the manager node use the <code>net start es-cluster1</code> command.</li>\n<li sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"215\" sourceendlinenumber=\"215\">To stop the manager node use the <code>net stop es-cluster1</code> command.</li>\n</ul>\n","type":"Conceptual","source":{"remote":{"path":"server/cluster-with-manager-nodes.md","branch":"swagger-docfx","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0,"endLine":0,"isExternal":false},"path":"server/cluster-with-manager-nodes.md","documentation":{"remote":{"path":"server/cluster-with-manager-nodes.md","branch":"swagger-docfx","repo":"git@github.com:EventStore/docs.geteventstore.com.git"},"startLine":0,"endLine":0,"isExternal":false},"_docfxVersion":"2.31.0.0","_systemKeys":["conceptual","type","source","path","documentation","title","rawTitle","wordCount"],"title":"Setting up a Cluster with Manager Nodes","rawTitle":"<h1 id=\"setting-up-a-cluster-with-manager-nodes\" sourcefile=\"server/cluster-with-manager-nodes.md\" sourcestartlinenumber=\"1\" sourceendlinenumber=\"1\">Setting up a Cluster with Manager Nodes</h1>","wordCount":1761,"_lang":"csharp","_tocPath":"docs/toc.html","_rel":"../../","_path":"docs/server/cluster-with-manager-nodes.html","_key":"server/cluster-with-manager-nodes.md","_tocRel":"../toc.html","_tocKey":"~/toc.md","__global":{"classesInSubtitle":"Classes","structsInSubtitle":"Structs","interfacesInSubtitle":"Interfaces","enumsInSubtitle":"Enums","delegatesInSubtitle":"Delegates","constructorsInSubtitle":"Constructors","fieldsInSubtitle":"Fields","propertiesInSubtitle":"Properties","methodsInSubtitle":"Methods","eventsInSubtitle":"Events","operatorsInSubtitle":"Operators","eiisInSubtitle":"Explicit Interface Implementations","functionsInSubtitle":"Functions","membersInSubtitle":"Members","improveThisDoc":"Improve this Doc","viewSource":"View Source","inheritance":"Inheritance","inheritedMembers":"Inherited Members","namespace":"Namespace","assembly":"Assembly","syntax":"Syntax","overrides":"Overrides","implements":"Implements","remarks":"Remarks","examples":"Examples","seealso":"See Also","declaration":"Declaration","parameters":"Parameters","typeParameters":"Type Parameters","type":"Type","name":"Name","description":"Description","returns":"Returns","fieldValue":"Field Value","propertyValue":"Property Value","eventType":"Event Type","exceptions":"Exceptions","condition":"Condition","extensionMethods":"Extension Methods","note":"<h5>Note</h5>","warning":"<h5>Warning</h5>","tip":"<h5>Tip</h5>","important":"<h5>Important</h5>","caution":"<h5>Caution</h5>","_shared":{}}}